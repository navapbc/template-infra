#!/usr/bin/env bash
# -----------------------------------------------------------------------------
# Convenience script for running terraform init followed by terraform apply
# See ./bin/terraform-init and ./bin/terraform-apply for more details.
#
# Positional parameters:
# module_dir (required) – The location of the root module to initialize and apply
# config_name (required) – The name of the tfbackend and tfvars config. The name
#   is expected to be consistent for both the tfvars file and the tfbackend file.
# -----------------------------------------------------------------------------
set -euo pipefail

module_dir="$1"
config_name="$2"

./bin/terraform-init "${module_dir}" "${config_name}"

./bin/terraform-apply "${module_dir}" "${config_name}"
